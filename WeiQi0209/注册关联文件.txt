void SetAssociate()
{
    LPCTSTR    szKeyEnter = TEXT("mwqfile");
    LPCTSTR    szKeyExt1 = TEXT(".mwq");
    LPCTSTR    szKeyExt2 = TEXT("mwqfile \\shell\\open\\command");
    LPCTSTR	szKeyExt3 = TEXT("mwqfile \\DefaultIcon");
    LPCTSTR    szParam = TEXT("  \"%1\"");
    HKEY    hKey;
    char    szFileName[MAX_PATH];
    char	szIconName[] = "E:\\Windows≥Ã–Ú…Ëº∆\\Chap11\\PopPad3\\HexCalc.ico";
    if ( ERROR_SUCCESS == RegCreateKey(HKEY_CLASSES_ROOT, szKeyExt1, &hKey))
    {
	RegSetValueEx(hKey, NULL, 0, REG_SZ, szKeyEnter, sizeof(szKeyEnter));
        RegCloseKey(hKey);
    }
    if ( ERROR_SUCCESS == RegCreateKey(HKEY_CLASSES_ROOT, szKeyExt2, &hKey) )
    {
        GetModuleFileName(NULL, szFileName, sizeof(szFileName));
        lstrcat(szFileName, szParam);
        RegSetValueEx(hKey, NULL, 0, REG_EXPAND_SZ, szFileName, strlen(szFileName) + 1);
        RegCloseKey(hKey);
    }
    if ( ERROR_SUCCESS == RegCreateKey(HKEY_CLASSES_ROOT, szKeyExt3, &hKey) )
    {
	RegSetValueEx(hKey, NULL, 0, REG_SZ, szIconName, sizeof(szIconName));
        RegCloseKey(hKey);
        SendMessage(HWND_BROADCAST, WM_SETTINGCHANGE, 0, 0);
    }
}


LPCTSTR    szKeyEnter = TEXT("mwqfile");
LPCTSTR    szKeyExt1 = TEXT(".mwq");
HKEY    hKey;
if ( ERROR_SUCCESS == RegCreateKey(HKEY_CLASSES_ROOT, szKeyExt1, &hKey))
{
    RegSetValueEx(hKey, NULL, 0, REG_SZ, szKeyEnter, sizeof(szKeyEnter));
    RegCloseKey(hKey);
}


